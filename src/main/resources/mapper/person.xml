<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.help.dao.PersonDao">
    <select id="findPerson"  resultType="com.help.entity.Person">
       select p.*,s.sta_name ,r.why FROM person p LEFT JOIN person_state ps
      on p.pid= ps.pid LEFT JOIN state s ON ps.sta_id=s.sta_id LEFT JOIN reason r ON ps.wid=r.wid
    </select>
    <select id="findPersonBySta1"  resultType="com.help.entity.Person">
        select p.*,s.sta_name ,r.why FROM person p LEFT JOIN person_state ps
        on p.pid= ps.pid LEFT JOIN state s ON ps.sta_id=s.sta_id LEFT JOIN reason r ON ps.wid=r.wid
         where s.sta_name="审核通过"
    </select>
    <select id="findPersonBySta2"  resultType="com.help.entity.Person">
        select p.*,s.sta_name ,r.why FROM person p LEFT JOIN person_state ps
        on p.pid= ps.pid LEFT JOIN state s ON ps.sta_id=s.sta_id LEFT JOIN reason r ON ps.wid=r.wid
        where s.sta_name="审批通过"
    </select>
    <select id="findPersonNull"  resultType="com.help.entity.Person">
        select p.*,s.sta_name ,r.why FROM person p LEFT JOIN person_state ps
        on p.pid= ps.pid LEFT JOIN state s ON ps.sta_id=s.sta_id LEFT JOIN reason r ON ps.wid=r.wid
        where s.sta_name is null
    </select>
    <select id="findPersonByName"  resultType="com.help.entity.Person">
        select p.*,s.sta_name ,r.why FROM person p LEFT JOIN person_state ps
      on p.pid= ps.pid LEFT JOIN state s ON ps.sta_id=s.sta_id LEFT JOIN reason r ON ps.wid=r.wid
      where p_name=#{p_name}
    </select>
    <insert id="addDangan" parameterType="com.help.entity.Person">
        insert into person(p_name,p_gender,p_age,identify,p_race,p_hukou,p_homesum,p_first,p_ill,p_trade,p_marry,p_phone,p_adress,p_workable)
        values(#{p_name},#{p_gender},#{p_age},#{identify},#{p_race},#{p_hukou},#{p_homesum},#{p_first},#{p_ill},#{p_trade},#{p_marry},#{p_phone},#{p_adress},#{p_workable})
    </insert>
    <update id="editDangan" parameterType="com.help.entity.Person" >
        update person set p_name=#{p_name},p_gender=#{p_gender},identify=#{identify},p_race=#{p_race},p_hukou=#{p_hukou},p_homesum=#{p_homesum},
        p_first=#{p_first},p_ill=#{p_ill},p_trade=#{p_trade},p_marry=#{p_marry},p_phone=#{p_phone},p_adress=#{p_adress},p_workable=#{p_workable}
        where pid=#{pid}
    </update>
    <delete id="removeDanganId">
        delete from person where pid in
        <foreach collection="list" item="x" open="(" separator="," close=")">
            #{x}
        </foreach>
    </delete>
</mapper>